<html>

<script>
    function includeHTML() {
        var z, i, elmnt, file, xhttp;
        /*loop through a collection of all HTML elements:*/
        z = document.getElementsByTagName("*");
        for (i = 0; i < z.length; i++) {
            elmnt = z[i];
            /*search for elements with a certain attribute:*/
            file = elmnt.getAttribute("nav-bar");
            if (file) {
                /*make an HTTP request using the attribute value as the file name:*/
                xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function () {
                    if (this.readyState == 4) {
                        if (this.status == 200) { elmnt.innerHTML = this.responseText; }
                        if (this.status == 404) { elmnt.innerHTML = "Page not found."; }
                        /*remove the attribute, and call this function once more:*/
                        elmnt.removeAttribute("nav-bar");
                        includeHTML();
                    }
                }
                xhttp.open("GET", file, true);
                xhttp.send();
                /*exit the function:*/
                return;
            }
        }
    };
</script>

<head>
    <title>zeber</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="css/styles.css">
</head>

<body lang=EN-US style='word-wrap:break-word'>
    <div nav-bar="nav_bar.html"></div>

    <h1 class="page-title">
        Hours of operation 4:30 - 7:00
    </h1>

    <div class="content-container">
        <table id="myTable" border=1 cellspacing=10 cellpadding=10 style='border-collapse:collapse;border:none'>
            <tr>
                <td class="menu-img-cell">
                    <img width="186" height="279" id="Picture 1" src="order_files/Miller-Lite.png"
                        alt="A can of beer with a logo">
                </td>
                <td class="menu-description-cell">
                    Miller Lite<br>10 &#162
                </td>
                <td class="menu-cell">
                    <input type="number" value="0" min="0" id="num1" style="font-size: 75px; max-width: 3.5ch;">
                </td>
                <td class="menu-cell">
                    <button onclick="increase('num1')" style="font-size: 75px; width: 2ch;">+</button><br>
                    <button onclick="decrease('num1')" style="font-size: 75px; width: 2ch;">-</button>
                </td>
            </tr>
            <tr>
                <td class="menu-img-cell">
                    <img width=136 height=230 id="Picture 2" src="order_files/generic-beer.jpg"
                        alt="A can of beer with a blue label and a yellow sun and boats">
                </td>
                <td class="menu-description-cell">
                    Generic Beer<br>10 &#162
                </td>
                <td class="menu-cell">
                    <input type="number" value="0" min="0" id="num2" style="font-size: 75px; max-width: 3.5ch;">
                </td>
                <td class="menu-cell">
                    <button onclick="increase('num2')" style="font-size: 75px; width: 2ch;">+</button><br>
                    <button onclick="decrease('num2')" style="font-size: 75px; width: 2ch;">-</button>
                </td>
            </tr>
            <tr>
                <td class="menu-img-cell">
                    <img width=221 height=173 id="Picture 3" src="order_files/beer_running.jpeg" alt="beer running">
                </td>
                <td class="menu-description-cell">
                    Any beer delivery<br>10 &#162
                </td>
                <td class="menu-cell">
                    <input type="number" value="0" min="0" id="num3" style="font-size: 75px; max-width: 3.5ch;">
                </td>
                <td class="menu-cell">
                    <button onclick="increase('num3')" style="font-size: 75px; width: 2ch;">+</button><br>
                    <button onclick="decrease('num3')" style="font-size: 75px; width: 2ch;">-</button>
                </td>
            </tr>
            <tr>
                <td class="menu-img-cell">
                    <img width=199 height=199 id="Picture 4" src="order_files/chips_and_guacamole.jpg" alt="chips">
                </td>
                <td class="menu-description-cell">
                    Chips<br>10 &#162
                </td>
                <td class="menu-cell">
                    <input type="number" value="0" min="0" id="num4" style="font-size: 75px; max-width: 3.5ch;">
                </td>
                <td class="menu-cell">
                    <button onclick="increase('num4')" style="font-size: 75px; width: 2ch;">+</button><br>
                    <button onclick="decrease('num4')" style="font-size: 75px; width: 2ch;">-</button>
                </td>
            </tr>
            <tr>
                <td class="menu-img-cell">
                    <img width=281 height=256 id="Picture 5" src="order_files/chair.jpg"
                        alt="A green folding chair with a cup holder">
                </td>
                <td class="menu-description-cell">
                    Chair moving services<br>5 &#162
                </td>
                <td class="menu-cell">
                    <input type="number" value="0" min="0" id="num5" style="font-size: 75px; max-width: 3.5ch;">
                </td>
                <td class="menu-cell">
                    <button onclick="increase('num5')" style="font-size: 75px; width: 2ch;">+</button><br>
                    <button onclick="decrease('num5')" style="font-size: 75px; width: 2ch;">-</button>
                </td>
            </tr>
            <tr>
                <td class="menu-img-cell">
                    <img width=254 height=167 id="Picture 6" src="order_files/hammock.jpeg" alt="hammock">
                </td>
                <td class="menu-description-cell">
                    Hammock rental<br>15 &#162 per hour
                </td>
                <td class="menu-cell">
                    <input type="number" value="0" min="0" id="num6" style="font-size: 75px; max-width: 3.5ch;">
                </td>
                <td class="menu-cell">
                    <button onclick="increase('num6')" style="font-size: 75px; width: 2ch;">+</button><br>
                    <button onclick="decrease('num6')" style="font-size: 75px; width: 2ch;">-</button>
                </td>
            </tr>
            <tr>
                <td class="menu-img-cell">
                    <img width=254 height=260 id="Picture 7" src="order_files/redball_poster.jpg"
                        alt="redball entertainment">
                </td>
                <td class="menu-description-cell">
                    Redball tickets<br>10 &#162
                </td>
                <td class="menu-cell">
                    <input type="number" value="0" min="0" id="num7" style="font-size: 75px; max-width: 3.5ch;">
                </td>
                <td class="menu-cell">
                    <button onclick="increase('num7')" style="font-size: 75px; width: 2ch;">+</button><br>
                    <button onclick="decrease('num7')" style="font-size: 75px; width: 2ch;">-</button>
                </td>
            </tr>
            <tr>
                <td class="menu-img-cell">
                    <img width=254 height=167 id="Picture 8"
                        src="order_files/trophy-on-field-under-stadium-lights-at-night-photo.jpg"
                        alt="redball tournament trophy">
                </td>
                <td class="menu-description-cell">
                    Redball tournament registration<br>10 &#162
                </td>
                <td class="menu-cell">
                    <input type="number" value="0" min="0" id="num8" style="font-size: 75px; max-width: 3.5ch;">
                </td>
                <td class="menu-cell">
                    <button onclick="increase('num8')" style="font-size: 75px; width: 2ch;">+</button><br>
                    <button onclick="decrease('num8')" style="font-size: 75px; width: 2ch;">-</button>
                </td>
            </tr>
        </table>
        <br><br>
        <table style="font-family: Consolas; font-size: 60px;">
            <tr>
                <td>
                    <table style="font-family: Consolas; font-size: 60px;">
                        <tr>

                            <td>
                                <label for="personID">Person:</label>
                                <select id="personID" name="personID" style="font-size: 72px;">
                                    <option value="Grandpa">Grandpa</option>
                                    <option value="Grandma">Grandma</option>
                                    <option value="Jess">Jess</option>
                                    <option value="Mario">Mario</option>
                                    <option value="Dad">Dad</option>
                                    <option value="Mom">Mom</option>
                                    <option value="James">James</option>
                                    <option value="Jaclyn">Jaclyn</option>
                                    <option value="Joel">Joel</option>
                                    <option value="Jenn">Jenn</option>
                                </select>

                            </td>
                        </tr>

                    </table>
                <td>
                    <button id="submitBtn" type="submit" onclick="submit()" style="font-size: 60px;">
                        Submit<br>Order
                    </button>
                </td>
            </tr>
        </table>
    </div>

    <p style="font-size: 120px; font-family: Consolas; text-align: center;">
        <br> <br>
    </p>


    <div id="output"> </div>
    <script>

        includeHTML();

        // Set the cookie with the selected values
        function setCookie(name, value) {
            console.log('cookie ' + name + ' = ' + value);
            document.cookie = `${name}=${value}; path=/`;
        }
        // Read the cookie value
        function getCookie(name) {
            const cookies = document.cookie.split('; ');
            for (const cookie of cookies) {
                const [cookieName, cookieValue] = cookie.split('=');
                if (cookieName === name) {
                    return cookieValue;
                }
            }
            return null;
        }
        // On page load:
        window.onload = function () {
            const lastPersonID = getCookie('personID');

            // Populate the drop-down boxes with the last selected values
            const personSelect = document.getElementById('personID');

            if (lastPersonID) {
                personSelect.value = lastPersonID;
            }

        };
        // Call the onload function to set the drop-down box values on page load
        window.onload();
        function increase(id) {
            var input = document.getElementById(id);
            input.value = parseInt(input.value) + 1;
        }
        function decrease(id) {
            var input = document.getElementById(id);
            if (input.value > 0) {
                input.value = parseInt(input.value) - 1;
            }
        }
        function submit() {

            setCookie('personID', document.getElementById('personID').value);

            document.getElementById('output').innerText = "Submitting order...";
            document.getElementById('submitBtn').innerHTML = "Submitting...";
            document.getElementById('submitBtn').disabled = true;

            var table = document.getElementById('myTable');
            var inputs = table.getElementsByTagName('input')
            var items = [];
            var out_str = "?";
            for (var i = 0; i < inputs.length; i++) {
                items.push('item ' + (i + 1) + ': ' + inputs[i].value);
                out_str += 'item' + [i + 1] + "=" + inputs[i].value + "&";
            }

            out_str += 'person=' + document.getElementById('personID').value;

            var macroID = 'AKfycbxw_eW2VRCl4ZQY3CIBR-iJmJAste0Xx4LBk22mwuHnT9V1Qi_eRZiHV5IQehaODqnOpQ';
            fetch('https://script.google.com/macros/s/' + macroID + '/exec' + out_str, { mode: 'no-cors' })
                .then(response => response.text())
                .then(data => {
                    console.log(data); // Write response data to the console
                    document.getElementById('output').innerText = data;
                    window.location.href = "checkout.html";
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }
    </script>
</body>

</html>